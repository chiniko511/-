(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{408:(e,t,r)=>{Promise.resolve().then(r.bind(r,9349))},9349:(e,t,r)=>{"use strict";r.d(t,{default:()=>y});var s=r(8081),a=r(2149);let l=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),n=function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return t.filter((e,t,r)=>!!e&&""!==e.trim()&&r.indexOf(e)===t).join(" ").trim()};var o={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};let i=(0,a.forwardRef)((e,t)=>{let{color:r="currentColor",size:s=24,strokeWidth:l=2,absoluteStrokeWidth:i,className:c="",children:d,iconNode:x,...g}=e;return(0,a.createElement)("svg",{ref:t,...o,width:s,height:s,stroke:r,strokeWidth:i?24*Number(l)/Number(s):l,className:n("lucide",c),...g},[...x.map(e=>{let[t,r]=e;return(0,a.createElement)(t,r)}),...Array.isArray(d)?d:[d]])}),c=(e,t)=>{let r=(0,a.forwardRef)((r,s)=>{let{className:o,...c}=r;return(0,a.createElement)(i,{ref:s,iconNode:t,className:n("lucide-".concat(l(e)),o),...c})});return r.displayName="".concat(e),r},d=c("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]),x=c("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]),g=c("Copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]]);function m(e){let{song:t,selectedCategories:r,onCategoryClick:l}=e,[n,o]=(0,a.useState)(!1);return(0,s.jsxs)("div",{className:"song-card bg-white rounded-lg shadow p-4 border-l-4 ".concat((e=>{if(!e)return"border-gray-500";let t=["border-pink-500","border-blue-500","border-yellow-500","border-green-500","border-purple-500","border-red-500","border-indigo-500","border-orange-500","border-teal-500"],r=0;for(let t=0;t<e.length;t++)r=e.charCodeAt(t)+((r<<5)-r);let s=Math.abs(r)%t.length;return t[s]})(t.language)," hover:border-indigo-500 relative transition-all duration-300 hover:-translate-y-1 hover:shadow-md"),children:[(0,s.jsx)("h3",{className:"text-base sm:text-lg font-bold text-gray-800 pr-10 line-clamp-1",children:t.title||""}),(0,s.jsxs)("div",{className:"flex flex-wrap justify-between items-center mt-2 gap-1",children:[(0,s.jsx)("p",{className:"text-sm sm:text-base text-gray-600 line-clamp-1 mr-2",children:t.artist||""}),t.language&&(0,s.jsx)("span",{className:"language-tag px-2 py-1 text-xs rounded-full ".concat((e=>{if(!e)return"bg-gray-100 text-gray-800";let t=["bg-pink-100 text-pink-800","bg-blue-100 text-blue-800","bg-yellow-100 text-yellow-800","bg-green-100 text-green-800","bg-purple-100 text-purple-800","bg-red-100 text-red-800","bg-indigo-100 text-indigo-800","bg-orange-100 text-orange-800","bg-teal-100 text-teal-800"],r=0;for(let t=0;t<e.length;t++)r=e.charCodeAt(t)+((r<<5)-r);let s=Math.abs(r)%t.length;return t[s]})(t.language)," whitespace-nowrap"),children:t.language})]}),t.categories&&t.categories.length>0&&(0,s.jsx)("div",{className:"mt-2 flex flex-wrap",children:t.categories.map(e=>e&&(0,s.jsx)("span",{className:"inline-block px-2 py-1 text-xs rounded-full mr-1 mb-1 cursor-pointer ".concat(r.has(e)?"bg-purple-200 text-purple-800 font-medium":"bg-purple-100 text-purple-800"),onClick:()=>l(e),children:e},e))}),t.notes&&(0,s.jsxs)("p",{className:"mt-2 text-xs sm:text-sm text-gray-500 line-clamp-2",children:[(0,s.jsx)("span",{className:"font-medium",children:"備註:"})," ",t.notes]}),(0,s.jsx)("div",{className:"absolute top-3 right-3",children:(0,s.jsxs)("button",{className:"p-2 bg-pink-100 hover:bg-pink-200 text-pink-700 rounded-full focus:outline-none shadow-md transition-all duration-200 hover:-translate-y-1 active:scale-95",onClick:()=>{let e="".concat(t.artist," - ").concat(t.title).trim();if(navigator.clipboard)navigator.clipboard.writeText(e).then(()=>{o(!0),setTimeout(()=>o(!1),2500)}).catch(e=>{console.error("Failed to copy: ",e)});else{let t=document.createElement("textarea");t.value=e,document.body.appendChild(t),t.select();try{document.execCommand("copy"),o(!0),setTimeout(()=>o(!1),2500)}catch(e){console.error("Fallback: Copy command failed",e)}document.body.removeChild(t)}},"aria-label":"複製歌曲資訊",children:[(0,s.jsx)(g,{className:"h-5 w-5"}),(0,s.jsx)("span",{className:"absolute -top-8 right-0 bg-indigo-600 text-white text-xs px-2 py-1 rounded pointer-events-none transition-opacity ".concat(n?"opacity-100":"opacity-0"),children:"已複製!"})]})})]})}function u(e){let{categories:t,selectedCategories:r,categoryCounts:a,onToggleCategory:l,onClearCategories:n}=e,o=[...t].sort((e,t)=>(a[t]||0)-(a[e]||0));return(0,s.jsx)("div",{className:"flex gap-1.5 sm:gap-2 flex-wrap",children:o.map(e=>(0,s.jsxs)("button",{className:"px-2 sm:px-3 py-1.5 sm:py-2 rounded-lg bg-purple-100 hover:bg-purple-200 text-purple-700 font-medium flex items-center text-xs sm:text-sm transition-all duration-200 ".concat(r.has(e)?"bg-purple-500 text-white hover:bg-purple-600 -translate-y-1 shadow-md":""),onClick:()=>l(e),children:[(0,s.jsx)("span",{className:"line-clamp-1",children:e}),(0,s.jsx)("span",{className:"ml-1 inline-flex items-center justify-center min-w-[18px] h-4 sm:min-w-[20px] sm:h-5 px-1 sm:px-1.5 rounded-full text-xs font-semibold ".concat(r.has(e)?"bg-white/30 text-white":"bg-purple-200 text-purple-800"),children:a[e]||0})]},e))})}function p(e){let{languages:t,currentLanguage:r,onSelectLanguage:a}=e;return(0,s.jsx)("div",{className:"flex gap-1.5 sm:gap-2 flex-wrap",children:t.sort().map(e=>(0,s.jsx)("button",{className:"px-2 sm:px-3 py-1.5 sm:py-2 rounded-lg bg-gray-100 hover:bg-gray-200 text-gray-700 font-medium text-xs sm:text-sm transition-colors ".concat(r===e?"bg-indigo-600 text-white hover:bg-indigo-700":""),onClick:()=>a(e),children:e},e))})}function h(e){let{totalSongs:t,languages:r,languageCounts:a,categoryCounts:l}=e,n=e=>{if(!e)return"bg-gray-50";let t=["bg-pink-50","bg-blue-50","bg-yellow-50","bg-green-50","bg-purple-50","bg-red-50","bg-indigo-50","bg-orange-50","bg-teal-50"],r=0;for(let t=0;t<e.length;t++)r=e.charCodeAt(t)+((r<<5)-r);let s=Math.abs(r)%t.length;return t[s]},o=e=>{if(!e)return"text-gray-600";let t=["text-pink-600","text-blue-600","text-yellow-600","text-green-600","text-purple-600","text-red-600","text-indigo-600","text-orange-600","text-teal-600"],r=0;for(let t=0;t<e.length;t++)r=e.charCodeAt(t)+((r<<5)-r);let s=Math.abs(r)%t.length;return t[s]},i=Object.entries(a).sort((e,t)=>t[1]-e[1]).slice(0,2),c=Object.entries(l).sort((e,t)=>t[1]-e[1]).slice(0,1);return(0,s.jsxs)("div",{className:"bg-white rounded-xl shadow-lg p-4 sm:p-6",children:[(0,s.jsx)("h2",{className:"text-xl sm:text-2xl font-bold text-indigo-800 mb-3 sm:mb-4",children:"統計資訊"}),(0,s.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-2 sm:gap-4",children:[(0,s.jsxs)("div",{className:"bg-indigo-50 rounded-lg p-3 sm:p-4 text-center",children:[(0,s.jsx)("div",{className:"text-2xl sm:text-3xl font-bold text-indigo-600",children:t}),(0,s.jsx)("div",{className:"text-xs sm:text-sm text-gray-600",children:"總歌曲數"})]}),i.map(e=>{let[t,r]=e;return(0,s.jsxs)("div",{className:"".concat(n(t)," rounded-lg p-3 sm:p-4 text-center"),children:[(0,s.jsx)("div",{className:"text-2xl sm:text-3xl font-bold ".concat(o(t)),children:r}),(0,s.jsxs)("div",{className:"text-xs sm:text-sm text-gray-600",children:[t," 歌曲"]})]},t)}),c.map(e=>{let[t,r]=e;return(0,s.jsxs)("div",{className:"bg-purple-50 rounded-lg p-3 sm:p-4 text-center",children:[(0,s.jsx)("div",{className:"text-2xl sm:text-3xl font-bold text-purple-600",children:r}),(0,s.jsxs)("div",{className:"text-xs sm:text-sm text-gray-600 truncate",children:["最多: ",t]})]},t)})]})]})}let b=c("ChevronUp",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]);function f(){let[e,t]=(0,a.useState)(!1);return(0,a.useEffect)(()=>{let e=()=>{window.scrollY>300?t(!0):t(!1)};return window.addEventListener("scroll",e),()=>window.removeEventListener("scroll",e)},[]),(0,s.jsx)("button",{onClick:()=>{window.scrollTo({top:0,behavior:"smooth"})},className:"fixed bottom-6 right-6 p-3 rounded-full bg-indigo-600 text-white shadow-lg z-50 transition-all duration-300 ".concat(e?"opacity-100 translate-y-0":"opacity-0 translate-y-10 pointer-events-none"),"aria-label":"回到頂部",children:(0,s.jsx)(b,{className:"h-6 w-6"})})}function y(){let[e,t]=(0,a.useState)([]),[r,l]=(0,a.useState)([]),[n,o]=(0,a.useState)(""),[i,c]=(0,a.useState)("all"),[g,b]=(0,a.useState)(new Set),[y,w]=(0,a.useState)(new Set),[j,N]=(0,a.useState)(new Set),[v,C]=(0,a.useState)({}),[k,S]=(0,a.useState)(!0),[E,L]=(0,a.useState)(null);(0,a.useEffect)(()=>{A()},[]),(0,a.useEffect)(()=>{D()},[n,i,g,e]);let A=async()=>{S(!0),L(null);try{let e=await fetch("https://opensheet.elk.sh/".concat("1z-kl4dUioRrhJaq82O283991VPtg2PfXqx4eN5fQ9-8","/sheet1"));if(!e.ok)throw Error("Network response was not ok");let t=await e.json();z(t)}catch(e){console.error("Error fetching sheet data:",e),L("無法獲取歌曲數據")}finally{S(!1)}},z=e=>{let r=new Set,s=new Set,a={},n=e.map((e,t)=>{let l={id:t+1,title:e.歌名||e.title||e.Song||"",artist:e.歌手||e.artist||e.Artist||"",language:e.語言||e.language||e.Language||"",category:e.分類||e.category||e.Category||"",notes:e.備註||e.notes||e.Notes||"",categories:[]};if(l.language&&r.add(l.language),l.category){let e=l.category.split(",").map(e=>e.trim());l.categories=e,e.forEach(e=>{e&&(s.add(e),a[e]=(a[e]||0)+1)})}return l});t(n),l(n),w(r),N(s),C(a)},D=()=>{let t=e;if("all"!==i&&(t=t.filter(e=>e.language===i)),g.size>0&&(t=t.filter(e=>{for(let t of g)if(!e.categories.includes(t))return!1;return!0})),n){let e=n.toLowerCase();t=t.filter(t=>t.title&&t.title.toLowerCase().includes(e)||t.artist&&t.artist.toLowerCase().includes(e)||t.language&&t.language.toLowerCase().includes(e)||t.category&&t.category.toLowerCase().includes(e)||t.notes&&t.notes.toLowerCase().includes(e))}M(t),l(t)},M=e=>{let t={};e.forEach(e=>{e.categories&&e.categories.length>0&&e.categories.forEach(e=>{e&&(t[e]=(t[e]||0)+1)})}),C(t)},O=e=>{let t=new Set(g);t.has(e)?t.delete(e):t.add(e),b(t)},_=()=>{b(new Set)};return(0,s.jsxs)("div",{className:"container mx-auto px-4 py-6 sm:py-8",children:[(0,s.jsxs)("header",{className:"text-center mb-6 sm:mb-10",children:[(0,s.jsx)("h1",{className:"text-3xl sm:text-4xl font-bold text-indigo-800 mb-1 sm:mb-2",children:"我的歌曲庫"}),(0,s.jsx)("p",{className:"text-gray-600 text-base sm:text-lg",children:"找到你喜歡的歌了嗎~\uD83D\uDC9C"})]}),(0,s.jsxs)("div",{className:"bg-white rounded-xl shadow-lg p-4 sm:p-6 mb-6 sm:mb-8",children:[(0,s.jsx)("div",{className:"mb-4 sm:mb-6",children:(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsx)("input",{type:"text",placeholder:"搜尋歌曲、歌手或語言...",className:"w-full px-3 sm:px-4 py-2.5 sm:py-3 rounded-lg border border-gray-300 focus:outline-none focus:ring-2 focus:ring-indigo-500 text-gray-700 text-sm sm:text-base",value:n,onChange:e=>o(e.target.value)}),(0,s.jsx)(d,{className:"h-4 w-4 sm:h-5 sm:w-5 absolute right-3 top-1/2 -translate-y-1/2 text-gray-400"})]})}),(0,s.jsxs)("div",{className:"mb-6",children:[(0,s.jsx)("div",{className:"flex justify-between items-center mb-3",children:(0,s.jsx)("h3",{className:"text-lg font-semibold text-gray-700",children:"分類"})}),(0,s.jsx)(u,{categories:Array.from(j),selectedCategories:g,categoryCounts:v,onToggleCategory:O,onClearCategories:_}),g.size>0&&(0,s.jsxs)("div",{className:"flex items-center mt-3",children:[(0,s.jsx)("button",{onClick:_,className:"text-sm text-purple-600 hover:text-purple-800 font-medium mr-2 px-3 py-1 bg-purple-50 rounded-lg hover:bg-purple-100 transition-colors",children:"清除所有"}),(0,s.jsx)("div",{className:"flex-grow px-3 py-2 bg-purple-50 rounded-lg",children:(0,s.jsx)("div",{className:"flex flex-wrap gap-1",children:Array.from(g).map(e=>(0,s.jsxs)("div",{className:"filter-tag bg-purple-200 text-purple-800 cursor-pointer text-xs px-2 py-1 rounded-full flex items-center mr-2 mb-1",onClick:()=>O(e),children:[(0,s.jsx)("span",{children:e}),(0,s.jsx)(x,{className:"h-3 w-3 ml-1"})]},e))})})]})]}),(0,s.jsx)("div",{className:"flex flex-col md:flex-row md:items-center gap-4 mb-6",children:(0,s.jsx)(p,{languages:Array.from(y),currentLanguage:i,onSelectLanguage:e=>{c(e)}})}),(0,s.jsxs)("div",{className:"text-gray-600 mb-4",children:[(0,s.jsx)("span",{className:"font-medium",children:r.length})," 首歌曲"]}),k&&(0,s.jsx)("div",{className:"flex justify-center py-10",children:(0,s.jsx)("div",{className:"h-10 w-10 rounded-full border-4 border-gray-200 border-t-indigo-600 animate-spin"})}),E&&(0,s.jsxs)("div",{className:"text-center py-10",children:[(0,s.jsx)("div",{className:"h-16 w-16 mx-auto text-red-400 mb-4",children:"⚠️"}),(0,s.jsx)("p",{className:"text-gray-600 text-lg",children:E}),(0,s.jsx)("p",{className:"text-gray-500 mt-2",children:"請確保Google Sheet格式正確，並且可以公開訪問"}),(0,s.jsx)("button",{onClick:A,className:"mt-4 px-4 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700",children:"重試"})]}),!k&&!E&&(0,s.jsx)(s.Fragment,{children:0===r.length?(0,s.jsxs)("div",{className:"text-center py-10",children:[(0,s.jsx)("div",{className:"h-16 w-16 mx-auto text-gray-400 mb-4",children:"\uD83D\uDE15"}),(0,s.jsx)("p",{className:"text-gray-600 text-lg",children:"沒有找到符合的歌曲"})]}):(0,s.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:r.map(e=>(0,s.jsx)(m,{song:e,selectedCategories:g,onCategoryClick:O},e.id))})})]}),(0,s.jsx)(h,{totalSongs:e.length,languages:Array.from(y),languageCounts:e.reduce((e,t)=>(t.language&&(e[t.language]=(e[t.language]||0)+1),e),{}),categoryCounts:v}),(0,s.jsx)(f,{})]})}}},e=>{var t=t=>e(e.s=t);e.O(0,[497,954,358],()=>t(408)),_N_E=e.O()}]);
